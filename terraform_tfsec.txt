Terraform validate with tfsec............................................[41mFailed[m
[2m- hook id: terraform_tfsec[m
[2m- exit code: 1[m

[0m[3mResults #1-2[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'ec2:CreateTags' on wildcarded resource 'arn:aws:ec2:*:*:volume/*'[0m [2m(2 similar results)[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/eks/iam.tf [2m[3mLines 149-152
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m    resources = [[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m      "arn:aws:ec2:*:*:volume/*",[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m      "arn:aws:ec2:*:*:snapshot/*",[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2mIndividual Causes
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/main.tf:74-89 (module.eks)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/main.tf:74-89 (module.eks)
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResults #3-4[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'ec2:DeleteTags' on wildcarded resource 'arn:aws:ec2:*:*:volume/*'[0m [2m(2 similar results)[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/eks/iam.tf [2m[3mLines 171-174
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  171[0m  [2mâ”‚[0m [0m[31m    resources = [[0m
[0m[0m[2m  172[0m  [2mâ”‚[0m [0m[31m      "arn:aws:ec2:*:*:volume/*",[0m
[0m[0m[2m  173[0m  [2mâ”‚[0m [0m[31m      "arn:aws:ec2:*:*:snapshot/*",[0m
[0m[0m[2m  174[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2mIndividual Causes
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/main.tf:74-89 (module.eks)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/main.tf:74-89 (module.eks)
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #5[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'ec2:DeleteVolume' on wildcarded resource '*'[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/eks/iam.tf [2m[3mLine 195
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  192[0m  [2mâ”‚[0m [0m[33m  statement {[0m
[0m[0m[2m  193[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  194[0m  [2mâ”‚[0m [0m[33m    effect    = "Allow"[0m
[0m[0m[2m  195[0m  [2mâ”‚[0m [0m[31m    resources = ["*"][0m
[0m[0m[2m  196[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  197[0m  [2mâ”‚[0m [0m[33m    actions = [[0m
[0m[0m[2m  198[0m  [2mâ”‚[0m [0m[33m      "ec2:DeleteVolume",[0m
[0m[0m[2m  199[0m  [2mâ”‚[0m [0m[33m      "ec2:DeleteSnapshot",[0m
[0m[0m[2m  200[0m  [2mâ”‚[0m [0m[33m    ][0m
[0m[0m[2m  201[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  202[0m  [2mâ”‚[0m [0m[33m    condition {[0m
[0m[0m[2m  203[0m  [2mâ”‚[0m [0m[33m      test     = "StringLike"[0m
[0m[0m[2m  204[0m  [2mâ”‚[0m [0m[33m      variable = "aws:ResourceTag/KubernetesCluster"[0m
[0m[0m[2m  205[0m  [2mâ”‚[0m [0m[33m      values   = [var.deploy_id][0m
[0m[0m[2m  206[0m  [2mâ”‚[0m [0m[33m    }[0m
[0m[0m[2m  207[0m  [2mâ”‚[0m [0m[33m  }[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #6[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'ec2:CreateSnapshot' on wildcarded resource '*'[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/eks/iam.tf [2m[3mLine 247
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  244[0m  [2mâ”‚[0m [0m[33m  statement {[0m
[0m[0m[2m  245[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  246[0m  [2mâ”‚[0m [0m[33m    effect    = "Allow"[0m
[0m[0m[2m  247[0m  [2mâ”‚[0m [0m[31m    resources = ["*"][0m
[0m[0m[2m  248[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  249[0m  [2mâ”‚[0m [0m[33m    actions = [[0m
[0m[0m[2m  250[0m  [2mâ”‚[0m [0m[33m      "ec2:CreateSnapshot",[0m
[0m[0m[2m  251[0m  [2mâ”‚[0m [0m[33m      "ec2:CreateTags",[0m
[0m[0m[2m  252[0m  [2mâ”‚[0m [0m[33m      "ec2:DeleteSnapshot",[0m
[0m[0m[2m  253[0m  [2mâ”‚[0m [0m[33m      "ec2:DeleteTags",[0m
[0m[0m[2m  254[0m  [2mâ”‚[0m [0m[33m      "ec2:DescribeAvailabilityZones",[0m
[0m[0m[2m  255[0m  [2mâ”‚[0m [0m[33m      "ec2:DescribeSnapshots",[0m
[0m[0m[2m  256[0m  [2mâ”‚[0m [0m[33m      "ec2:DescribeTags",[0m
[0m[0m[2m  257[0m  [2mâ”‚[0m [0m[33m    ][0m
[0m[0m[2m  258[0m  [2mâ”‚[0m [0m[33m  }[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #7[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 's3:ListBucket' on wildcarded resource '*'[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/eks/iam.tf [2m[3mLine 34
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   31[0m  [2mâ”‚[0m [0m[33m  statement {[0m
[0m[0m[2m   32[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   33[0m  [2mâ”‚[0m [0m[33m    effect    = "Allow"[0m
[0m[0m[2m   34[0m  [2mâ”‚[0m [0m[31m    resources = ["*"][0m
[0m[0m[2m   35[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   36[0m  [2mâ”‚[0m [0m[33m    actions = [[0m
[0m[0m[2m   37[0m  [2mâ”‚[0m [0m[33m      "s3:ListBucket",[0m
[0m[0m[2m   38[0m  [2mâ”‚[0m [0m[33m      "s3:GetBucketLocation",[0m
[0m[0m[2m   39[0m  [2mâ”‚[0m [0m[33m      "s3:ListBucketMultipartUploads",[0m
[0m[0m[2m   40[0m  [2mâ”‚[0m [0m[33m    ][0m
[0m[0m[2m   41[0m  [2mâ”‚[0m [0m[33m  }[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResults #8-11[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 's3:PutObject' on wildcarded resource 'arn:aws:s3:::'[0m [2m(4 similar results)[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/eks/iam.tf [2m[3mLines 47-52
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   47[0m  [2mâ”‚[0m [0m[31m    resources = [[0m
[0m[0m[2m   48[0m  [2mâ”‚[0m [0m[31m      "arn:aws:s3:::${var.deploy_id}-blobs*",[0m
[0m[0m[2m   49[0m  [2mâ”‚[0m [0m[31m      "arn:aws:s3:::${var.deploy_id}-logs*",[0m
[0m[0m[2m   50[0m  [2mâ”‚[0m [0m[31m      "arn:aws:s3:::${var.deploy_id}-backups*",[0m
[0m[0m[2m   51[0m  [2mâ”‚[0m [0m[31m      "arn:aws:s3:::${var.deploy_id}-registry*",[0m
[0m[0m[2m   52[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2mIndividual Causes
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/main.tf:74-89 (module.eks)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/main.tf:74-89 (module.eks)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/main.tf:74-89 (module.eks)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/main.tf:74-89 (module.eks)
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #12[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'autoscaling:SetDesiredCapacity' on wildcarded resource '*'[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/eks/iam.tf [2m[3mLine 87
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[33m  statement {[0m
[0m[0m[2m   85[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   86[0m  [2mâ”‚[0m [0m[33m    effect    = "Allow"[0m
[0m[0m[2m   87[0m  [2mâ”‚[0m [0m[31m    resources = ["*"][0m
[0m[0m[2m   88[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   89[0m  [2mâ”‚[0m [0m[33m    actions = [[0m
[0m[0m[2m   90[0m  [2mâ”‚[0m [0m[33m      "autoscaling:DescribeAutoScalingInstances",[0m
[0m[0m[2m   91[0m  [2mâ”‚[0m [0m[33m      "autoscaling:SetDesiredCapacity",[0m
[0m[0m[2m   92[0m  [2mâ”‚[0m [0m[33m      "autoscaling:TerminateInstanceInAutoScalingGroup",[0m
[0m[0m[2m   93[0m  [2mâ”‚[0m [0m[33m    ][0m
[0m[0m[2m   94[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   95[0m  [2mâ”‚[0m [0m[33m    condition {[0m
[0m[0m[2m   96[0m  [2mâ”‚[0m [0m[33m      test     = "StringEquals"[0m
[0m[0m[2m   97[0m  [2mâ”‚[0m [0m[33m      variable = "autoscaling:ResourceTag/eks:cluster-name"[0m
[0m[0m[2m   98[0m  [2mâ”‚[0m [0m[33m      values   = [var.deploy_id][0m
[0m[0m[2m   99[0m  [2mâ”‚[0m [0m[33m    }[0m
[0m[0m[2m  100[0m  [2mâ”‚[0m [0m[33m  }[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #13[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #14[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #15[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #16[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #17[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [3m[2mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #18[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #19[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #20[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [3m[2mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #21[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #22[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #23[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #24[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #25[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #26[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [3m[2mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #27[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #28[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [3m[2mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #29[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #30[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [3m[2mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #31[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [3m[2mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #32[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #33[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #34[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #35[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #36[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #37[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #38[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #39[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #40[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #41[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #42[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #43[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #44[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [3m[2mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #45[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [3m[2mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #46[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #47[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [3m[2mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #48[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [3m[2mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #49[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #50[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #51[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #52[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #53[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #54[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #55[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #56[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #57[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3msubmodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 2.427674ms
[0m[0m  [2mparsing             [0m 67.362509ms
[0m[0m  [2madaptation          [0m 3.439651ms
[0m[0m  [2mchecks              [0m 17.628036ms
[0m[0m  [2mtotal               [0m 90.85787ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 6
[0m[0m  [2mblocks processed    [0m 188
[0m[0m  [2mfiles read          [0m 33
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 78
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 42
[0m[0m  [2mmedium              [0m 10
[0m[0m  [2mlow                 [0m 5
[0m
[0m  [31m[1m78 passed, 57 potential problem(s) detected.

[0m
[0m[3mResults #1-2[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'ec2:CreateTags' on wildcarded resource 'arn:aws:ec2:*:*:volume/*'[0m [2m(2 similar results)[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/eks/iam.tf [2m[3mLines 149-152
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m    resources = [[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m      "arn:aws:ec2:*:*:volume/*",[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m      "arn:aws:ec2:*:*:snapshot/*",[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2mIndividual Causes
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/example/main.tf:1-16 (module.domino_eks)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/example/main.tf:1-16 (module.domino_eks)
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResults #3-4[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'ec2:DeleteTags' on wildcarded resource 'arn:aws:ec2:*:*:volume/*'[0m [2m(2 similar results)[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/eks/iam.tf [2m[3mLines 171-174
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  171[0m  [2mâ”‚[0m [0m[31m    resources = [[0m
[0m[0m[2m  172[0m  [2mâ”‚[0m [0m[31m      "arn:aws:ec2:*:*:volume/*",[0m
[0m[0m[2m  173[0m  [2mâ”‚[0m [0m[31m      "arn:aws:ec2:*:*:snapshot/*",[0m
[0m[0m[2m  174[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2mIndividual Causes
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/example/main.tf:1-16 (module.domino_eks)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/example/main.tf:1-16 (module.domino_eks)
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #5[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'ec2:DeleteVolume' on wildcarded resource '*'[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/eks/iam.tf [2m[3mLine 195
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  192[0m  [2mâ”‚[0m [0m[33m  statement {[0m
[0m[0m[2m  193[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  194[0m  [2mâ”‚[0m [0m[33m    effect    = "Allow"[0m
[0m[0m[2m  195[0m  [2mâ”‚[0m [0m[31m    resources = ["*"][0m
[0m[0m[2m  196[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  197[0m  [2mâ”‚[0m [0m[33m    actions = [[0m
[0m[0m[2m  198[0m  [2mâ”‚[0m [0m[33m      "ec2:DeleteVolume",[0m
[0m[0m[2m  199[0m  [2mâ”‚[0m [0m[33m      "ec2:DeleteSnapshot",[0m
[0m[0m[2m  200[0m  [2mâ”‚[0m [0m[33m    ][0m
[0m[0m[2m  201[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  202[0m  [2mâ”‚[0m [0m[33m    condition {[0m
[0m[0m[2m  203[0m  [2mâ”‚[0m [0m[33m      test     = "StringLike"[0m
[0m[0m[2m  204[0m  [2mâ”‚[0m [0m[33m      variable = "aws:ResourceTag/KubernetesCluster"[0m
[0m[0m[2m  205[0m  [2mâ”‚[0m [0m[33m      values   = [var.deploy_id][0m
[0m[0m[2m  206[0m  [2mâ”‚[0m [0m[33m    }[0m
[0m[0m[2m  207[0m  [2mâ”‚[0m [0m[33m  }[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #6[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'ec2:CreateSnapshot' on wildcarded resource '*'[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/eks/iam.tf [2m[3mLine 247
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  244[0m  [2mâ”‚[0m [0m[33m  statement {[0m
[0m[0m[2m  245[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  246[0m  [2mâ”‚[0m [0m[33m    effect    = "Allow"[0m
[0m[0m[2m  247[0m  [2mâ”‚[0m [0m[31m    resources = ["*"][0m
[0m[0m[2m  248[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  249[0m  [2mâ”‚[0m [0m[33m    actions = [[0m
[0m[0m[2m  250[0m  [2mâ”‚[0m [0m[33m      "ec2:CreateSnapshot",[0m
[0m[0m[2m  251[0m  [2mâ”‚[0m [0m[33m      "ec2:CreateTags",[0m
[0m[0m[2m  252[0m  [2mâ”‚[0m [0m[33m      "ec2:DeleteSnapshot",[0m
[0m[0m[2m  253[0m  [2mâ”‚[0m [0m[33m      "ec2:DeleteTags",[0m
[0m[0m[2m  254[0m  [2mâ”‚[0m [0m[33m      "ec2:DescribeAvailabilityZones",[0m
[0m[0m[2m  255[0m  [2mâ”‚[0m [0m[33m      "ec2:DescribeSnapshots",[0m
[0m[0m[2m  256[0m  [2mâ”‚[0m [0m[33m      "ec2:DescribeTags",[0m
[0m[0m[2m  257[0m  [2mâ”‚[0m [0m[33m    ][0m
[0m[0m[2m  258[0m  [2mâ”‚[0m [0m[33m  }[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #7[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 's3:ListBucket' on wildcarded resource '*'[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/eks/iam.tf [2m[3mLine 34
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   31[0m  [2mâ”‚[0m [0m[33m  statement {[0m
[0m[0m[2m   32[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   33[0m  [2mâ”‚[0m [0m[33m    effect    = "Allow"[0m
[0m[0m[2m   34[0m  [2mâ”‚[0m [0m[31m    resources = ["*"][0m
[0m[0m[2m   35[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   36[0m  [2mâ”‚[0m [0m[33m    actions = [[0m
[0m[0m[2m   37[0m  [2mâ”‚[0m [0m[33m      "s3:ListBucket",[0m
[0m[0m[2m   38[0m  [2mâ”‚[0m [0m[33m      "s3:GetBucketLocation",[0m
[0m[0m[2m   39[0m  [2mâ”‚[0m [0m[33m      "s3:ListBucketMultipartUploads",[0m
[0m[0m[2m   40[0m  [2mâ”‚[0m [0m[33m    ][0m
[0m[0m[2m   41[0m  [2mâ”‚[0m [0m[33m  }[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResults #8-11[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 's3:PutObject' on wildcarded resource 'arn:aws:s3:::'[0m [2m(4 similar results)[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/eks/iam.tf [2m[3mLines 47-52
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   47[0m  [2mâ”‚[0m [0m[31m    resources = [[0m
[0m[0m[2m   48[0m  [2mâ”‚[0m [0m[31m      "arn:aws:s3:::${var.deploy_id}-blobs*",[0m
[0m[0m[2m   49[0m  [2mâ”‚[0m [0m[31m      "arn:aws:s3:::${var.deploy_id}-logs*",[0m
[0m[0m[2m   50[0m  [2mâ”‚[0m [0m[31m      "arn:aws:s3:::${var.deploy_id}-backups*",[0m
[0m[0m[2m   51[0m  [2mâ”‚[0m [0m[31m      "arn:aws:s3:::${var.deploy_id}-registry*",[0m
[0m[0m[2m   52[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2mIndividual Causes
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/example/main.tf:1-16 (module.domino_eks)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/example/main.tf:1-16 (module.domino_eks)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/example/main.tf:1-16 (module.domino_eks)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/example/main.tf:1-16 (module.domino_eks)
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #12[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'autoscaling:SetDesiredCapacity' on wildcarded resource '*'[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/eks/iam.tf [2m[3mLine 87
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[33m  statement {[0m
[0m[0m[2m   85[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   86[0m  [2mâ”‚[0m [0m[33m    effect    = "Allow"[0m
[0m[0m[2m   87[0m  [2mâ”‚[0m [0m[31m    resources = ["*"][0m
[0m[0m[2m   88[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   89[0m  [2mâ”‚[0m [0m[33m    actions = [[0m
[0m[0m[2m   90[0m  [2mâ”‚[0m [0m[33m      "autoscaling:DescribeAutoScalingInstances",[0m
[0m[0m[2m   91[0m  [2mâ”‚[0m [0m[33m      "autoscaling:SetDesiredCapacity",[0m
[0m[0m[2m   92[0m  [2mâ”‚[0m [0m[33m      "autoscaling:TerminateInstanceInAutoScalingGroup",[0m
[0m[0m[2m   93[0m  [2mâ”‚[0m [0m[33m    ][0m
[0m[0m[2m   94[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   95[0m  [2mâ”‚[0m [0m[33m    condition {[0m
[0m[0m[2m   96[0m  [2mâ”‚[0m [0m[33m      test     = "StringEquals"[0m
[0m[0m[2m   97[0m  [2mâ”‚[0m [0m[33m      variable = "autoscaling:ResourceTag/eks:cluster-name"[0m
[0m[0m[2m   98[0m  [2mâ”‚[0m [0m[33m      values   = [var.deploy_id][0m
[0m[0m[2m   99[0m  [2mâ”‚[0m [0m[33m    }[0m
[0m[0m[2m  100[0m  [2mâ”‚[0m [0m[33m  }[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #13[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #14[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #15[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #16[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #17[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #18[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #19[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #20[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #21[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #22[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #23[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #24[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [3m[2mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #25[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #26[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #27[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #28[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #29[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #30[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [3m[2mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #31[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #32[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #33[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #34[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #35[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [3m[2mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #36[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #37[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #38[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #39[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #40[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #41[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #42[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #43[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #44[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [3m[2mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #45[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #46[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #47[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #48[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #49[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #50[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #51[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #52[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #53[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #54[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #55[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #56[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #57[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3m../submodules/storage/main.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 3.539778ms
[0m[0m  [2mparsing             [0m 142.938486ms
[0m[0m  [2madaptation          [0m 3.508176ms
[0m[0m  [2mchecks              [0m 15.017841ms
[0m[0m  [2mtotal               [0m 165.004281ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 8
[0m[0m  [2mblocks processed    [0m 215
[0m[0m  [2mfiles read          [0m 41
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 98
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 42
[0m[0m  [2mmedium              [0m 10
[0m[0m  [2mlow                 [0m 5
[0m
[0m  [31m[1m98 passed, 57 potential problem(s) detected.

[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 257.752Âµs
[0m[0m  [2mparsing             [0m 1.954257ms
[0m[0m  [2madaptation          [0m 250.256Âµs
[0m[0m  [2mchecks              [0m 12.378276ms
[0m[0m  [2mtotal               [0m 14.840541ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 25
[0m[0m  [2mfiles read          [0m 4
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 9
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 0
[0m
[0m
[32m[1mNo problems detected!

[0m
[0m[3mResults #1-2[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'ec2:CreateTags' on wildcarded resource 'arn:aws:ec2:*:*:volume/*'[0m [2m(2 similar results)[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3miam.tf [2m[3mLines 149-152
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m    resources = [[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m      "arn:aws:ec2:*:*:volume/*",[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m      "arn:aws:ec2:*:*:snapshot/*",[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2mIndividual Causes
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/submodules/eks/iam.tf:109-208 (data.aws_iam_policy_document.ebs_csi)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/submodules/eks/iam.tf:109-208 (data.aws_iam_policy_document.ebs_csi)
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResults #3-4[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'ec2:DeleteTags' on wildcarded resource 'arn:aws:ec2:*:*:volume/*'[0m [2m(2 similar results)[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3miam.tf [2m[3mLines 171-174
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  171[0m  [2mâ”‚[0m [0m[31m    resources = [[0m
[0m[0m[2m  172[0m  [2mâ”‚[0m [0m[31m      "arn:aws:ec2:*:*:volume/*",[0m
[0m[0m[2m  173[0m  [2mâ”‚[0m [0m[31m      "arn:aws:ec2:*:*:snapshot/*",[0m
[0m[0m[2m  174[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2mIndividual Causes
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/submodules/eks/iam.tf:109-208 (data.aws_iam_policy_document.ebs_csi)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/submodules/eks/iam.tf:109-208 (data.aws_iam_policy_document.ebs_csi)
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #5[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'ec2:DeleteVolume' on wildcarded resource '*'[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3miam.tf [2m[3mLine 195
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  192[0m  [2mâ”‚[0m [0m[33m  statement {[0m
[0m[0m[2m  193[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  194[0m  [2mâ”‚[0m [0m[33m    effect    = "Allow"[0m
[0m[0m[2m  195[0m  [2mâ”‚[0m [0m[31m    resources = ["*"][0m
[0m[0m[2m  196[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  197[0m  [2mâ”‚[0m [0m[33m    actions = [[0m
[0m[0m[2m  198[0m  [2mâ”‚[0m [0m[33m      "ec2:DeleteVolume",[0m
[0m[0m[2m  199[0m  [2mâ”‚[0m [0m[33m      "ec2:DeleteSnapshot",[0m
[0m[0m[2m  200[0m  [2mâ”‚[0m [0m[33m    ][0m
[0m[0m[2m  201[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  202[0m  [2mâ”‚[0m [0m[33m    condition {[0m
[0m[0m[2m  203[0m  [2mâ”‚[0m [0m[33m      test     = "StringLike"[0m
[0m[0m[2m  204[0m  [2mâ”‚[0m [0m[33m      variable = "aws:ResourceTag/KubernetesCluster"[0m
[0m[0m[2m  205[0m  [2mâ”‚[0m [0m[33m      values   = [var.deploy_id][0m
[0m[0m[2m  206[0m  [2mâ”‚[0m [0m[33m    }[0m
[0m[0m[2m  207[0m  [2mâ”‚[0m [0m[33m  }[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #6[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'ec2:CreateSnapshot' on wildcarded resource '*'[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3miam.tf [2m[3mLine 247
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  244[0m  [2mâ”‚[0m [0m[33m  statement {[0m
[0m[0m[2m  245[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  246[0m  [2mâ”‚[0m [0m[33m    effect    = "Allow"[0m
[0m[0m[2m  247[0m  [2mâ”‚[0m [0m[31m    resources = ["*"][0m
[0m[0m[2m  248[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m  249[0m  [2mâ”‚[0m [0m[33m    actions = [[0m
[0m[0m[2m  250[0m  [2mâ”‚[0m [0m[33m      "ec2:CreateSnapshot",[0m
[0m[0m[2m  251[0m  [2mâ”‚[0m [0m[33m      "ec2:CreateTags",[0m
[0m[0m[2m  252[0m  [2mâ”‚[0m [0m[33m      "ec2:DeleteSnapshot",[0m
[0m[0m[2m  253[0m  [2mâ”‚[0m [0m[33m      "ec2:DeleteTags",[0m
[0m[0m[2m  254[0m  [2mâ”‚[0m [0m[33m      "ec2:DescribeAvailabilityZones",[0m
[0m[0m[2m  255[0m  [2mâ”‚[0m [0m[33m      "ec2:DescribeSnapshots",[0m
[0m[0m[2m  256[0m  [2mâ”‚[0m [0m[33m      "ec2:DescribeTags",[0m
[0m[0m[2m  257[0m  [2mâ”‚[0m [0m[33m    ][0m
[0m[0m[2m  258[0m  [2mâ”‚[0m [0m[33m  }[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #7[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 's3:ListBucket' on wildcarded resource '*'[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3miam.tf [2m[3mLine 34
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   31[0m  [2mâ”‚[0m [0m[33m  statement {[0m
[0m[0m[2m   32[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   33[0m  [2mâ”‚[0m [0m[33m    effect    = "Allow"[0m
[0m[0m[2m   34[0m  [2mâ”‚[0m [0m[31m    resources = ["*"][0m
[0m[0m[2m   35[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   36[0m  [2mâ”‚[0m [0m[33m    actions = [[0m
[0m[0m[2m   37[0m  [2mâ”‚[0m [0m[33m      "s3:ListBucket",[0m
[0m[0m[2m   38[0m  [2mâ”‚[0m [0m[33m      "s3:GetBucketLocation",[0m
[0m[0m[2m   39[0m  [2mâ”‚[0m [0m[33m      "s3:ListBucketMultipartUploads",[0m
[0m[0m[2m   40[0m  [2mâ”‚[0m [0m[33m    ][0m
[0m[0m[2m   41[0m  [2mâ”‚[0m [0m[33m  }[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResults #8-11[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 's3:PutObject' on wildcarded resource 'arn:aws:s3:::'[0m [2m(4 similar results)[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3miam.tf [2m[3mLines 47-52
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   47[0m  [2mâ”‚[0m [0m[31m    resources = [[0m
[0m[0m[2m   48[0m  [2mâ”‚[0m [0m[31m      "arn:aws:s3:::${var.deploy_id}-blobs*",[0m
[0m[0m[2m   49[0m  [2mâ”‚[0m [0m[31m      "arn:aws:s3:::${var.deploy_id}-logs*",[0m
[0m[0m[2m   50[0m  [2mâ”‚[0m [0m[31m      "arn:aws:s3:::${var.deploy_id}-backups*",[0m
[0m[0m[2m   51[0m  [2mâ”‚[0m [0m[31m      "arn:aws:s3:::${var.deploy_id}-registry*",[0m
[0m[0m[2m   52[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2mIndividual Causes
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/submodules/eks/iam.tf:30-62 (data.aws_iam_policy_document.s3)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/submodules/eks/iam.tf:30-62 (data.aws_iam_policy_document.s3)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/submodules/eks/iam.tf:30-62 (data.aws_iam_policy_document.s3)
[0m[0m  [2m- /Users/miguel.harmant/src/dominodatalab/terraform-aws-eks/submodules/eks/iam.tf:30-62 (data.aws_iam_policy_document.s3)
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #12[0m [0m[31mHIGH[39m[0m [1mIAM policy document uses sensitive action 'autoscaling:SetDesiredCapacity' on wildcarded resource '*'[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3miam.tf [2m[3mLine 87
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[33m  statement {[0m
[0m[0m[2m   85[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   86[0m  [2mâ”‚[0m [0m[33m    effect    = "Allow"[0m
[0m[0m[2m   87[0m  [2mâ”‚[0m [0m[31m    resources = ["*"][0m
[0m[0m[2m   88[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   89[0m  [2mâ”‚[0m [0m[33m    actions = [[0m
[0m[0m[2m   90[0m  [2mâ”‚[0m [0m[33m      "autoscaling:DescribeAutoScalingInstances",[0m
[0m[0m[2m   91[0m  [2mâ”‚[0m [0m[33m      "autoscaling:SetDesiredCapacity",[0m
[0m[0m[2m   92[0m  [2mâ”‚[0m [0m[33m      "autoscaling:TerminateInstanceInAutoScalingGroup",[0m
[0m[0m[2m   93[0m  [2mâ”‚[0m [0m[33m    ][0m
[0m[0m[2m   94[0m  [2mâ”‚[0m [0m[33m[0m
[0m[0m[2m   95[0m  [2mâ”‚[0m [0m[33m    condition {[0m
[0m[0m[2m   96[0m  [2mâ”‚[0m [0m[33m      test     = "StringEquals"[0m
[0m[0m[2m   97[0m  [2mâ”‚[0m [0m[33m      variable = "autoscaling:ResourceTag/eks:cluster-name"[0m
[0m[0m[2m   98[0m  [2mâ”‚[0m [0m[33m      values   = [var.deploy_id][0m
[0m[0m[2m   99[0m  [2mâ”‚[0m [0m[33m    }[0m
[0m[0m[2m  100[0m  [2mâ”‚[0m [0m[33m  }[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-iam-no-policy-wildcards
[0m[0m  [2m    Impact[0m Overly permissive policies may grant access to sensitive resources
[0m[0m  [2mResolution[0m Specify the exact permissions required, and to which resources they should apply instead of using wildcards.
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/iam/no-policy-wildcards/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/data-sources/iam_policy_document[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 613.791Âµs
[0m[0m  [2mparsing             [0m 19.144145ms
[0m[0m  [2madaptation          [0m 816.404Âµs
[0m[0m  [2mchecks              [0m 15.066847ms
[0m[0m  [2mtotal               [0m 35.641187ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 66
[0m[0m  [2mfiles read          [0m 8
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 68
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 12
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 0
[0m
[0m  [31m[1m68 passed, 12 potential problem(s) detected.

[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 253.601Âµs
[0m[0m  [2mparsing             [0m 4.323863ms
[0m[0m  [2madaptation          [0m 162.778Âµs
[0m[0m  [2mchecks              [0m 12.516196ms
[0m[0m  [2mtotal               [0m 17.256438ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 27
[0m[0m  [2mfiles read          [0m 4
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 0
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 0
[0m
[0m
[32m[1mNo problems detected!

[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 0s
[0m[0m  [2mparsing             [0m 0s
[0m[0m  [2madaptation          [0m 0s
[0m[0m  [2mchecks              [0m 0s
[0m[0m  [2mtotal               [0m 0s
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 0
[0m[0m  [2mblocks processed    [0m 0
[0m[0m  [2mfiles read          [0m 0
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 0
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 0
[0m
[0m
[32m[1mNo problems detected!

[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 465.765Âµs
[0m[0m  [2mparsing             [0m 1.754874ms
[0m[0m  [2madaptation          [0m 200.557Âµs
[0m[0m  [2mchecks              [0m 13.614491ms
[0m[0m  [2mtotal               [0m 16.035687ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 26
[0m[0m  [2mfiles read          [0m 9
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 0
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 0
[0m
[0m
[32m[1mNo problems detected!

[0m
[0m[3mResult #1[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #2[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #3[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #4[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #5[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #6[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #7[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [3m[2mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #8[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #9[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #10[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [3m[2mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #11[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #12[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #13[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #14[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #15[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [3m[2mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #16[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #17[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [3m[2mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #18[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #19[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #20[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #21[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #22[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #23[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [3m[2mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #24[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #25[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable blocking any PUT calls with a public ACL specified
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #26[0m [0m[31mHIGH[39m[0m [1mNo public access block so not blocking public policies[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-block-public-policy
[0m[0m  [2m    Impact[0m Users could put a policy that allows public access
[0m[0m  [2mResolution[0m Prevent policies that allow public access being PUT
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/block-public-policy/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#block_public_policy[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #27[0m [0m[31mHIGH[39m[0m [1mBucket does not have encryption enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [3m[2mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-encryption
[0m[0m  [2m    Impact[0m The bucket objects could be read if compromised
[0m[0m  [2mResolution[0m Configure bucket encryption
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-encryption/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #28[0m [0m[31mHIGH[39m[0m [1mNo public access block so not ignoring public acls[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [3m[2mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-ignore-public-acls
[0m[0m  [2m    Impact[0m PUT calls with public ACLs specified can make objects public
[0m[0m  [2mResolution[0m Enable ignoring the application of public ACLs in PUT calls
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/ignore-public-acls/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#ignore_public_acls[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #29[0m [0m[31mHIGH[39m[0m [1mNo public access block so not restricting public buckets[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-no-public-buckets
[0m[0m  [2m    Impact[0m Public buckets can be accessed by anyone
[0m[0m  [2mResolution[0m Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/no-public-buckets/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#restrict_public_bucketsÂ¡[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #30[0m [0m[31mHIGH[39m[0m [1mBucket does not encrypt data with a customer managed key.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-encryption-customer-key
[0m[0m  [2m    Impact[0m Using AWS managed keys does not allow for fine grained control
[0m[0m  [2mResolution[0m Enable encryption using customer managed keys
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/encryption-customer-key/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#enable-default-server-side-encryption[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #31[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #32[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #33[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #34[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #35[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #36[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #37[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #38[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #39[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have logging enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-bucket-logging
[0m[0m  [2m    Impact[0m There is no way to determine the access to this bucket
[0m[0m  [2mResolution[0m Add a logging block to the resource to enable access logging
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-bucket-logging/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #40[0m [0m[33mMEDIUM[39m[0m [1mBucket does not have versioning enabled[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-enable-versioning
[0m[0m  [2m    Impact[0m Deleted or modified data would not be recoverable
[0m[0m  [2mResolution[0m Enable versioning to protect against accidental/malicious removal or modification
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/enable-versioning/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#versioning[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #41[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 148-160
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  148[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "blobs" {[0m
[0m[0m[2m  149[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-blobs"[0m
[0m[0m[2m  150[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  151[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  152[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  153[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  154[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  155[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  156[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  157[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  158[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  159[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  160[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #42[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 223-235
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  223[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "logs" {[0m
[0m[0m[2m  224[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-logs"[0m
[0m[0m[2m  225[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  226[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  227[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  228[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  229[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  230[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  231[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  232[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  233[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  234[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  235[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #43[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 313-325
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  313[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "monitoring" {[0m
[0m[0m[2m  314[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-monitoring"[0m
[0m[0m[2m  315[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "true"[0m
[0m[0m[2m  316[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  317[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  318[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  319[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  320[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  321[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  322[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  323[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  324[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  325[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #44[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 421-434
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m  421[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "registry" {[0m
[0m[0m[2m  422[0m  [2mâ”‚[0m [0m[31m  arn                 = "arn:aws:s3:::${var.deploy_id}-registry"[0m
[0m[0m[2m  423[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-registry"[0m
[0m[0m[2m  424[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m  425[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m  426[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m  427[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m  428[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m  429[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m  430[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m  431[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m  432[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m  433[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m  434[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m[3mResult #45[0m [0m[97mLOW[39m[0m [1mBucket does not have a corresponding public access block.[0m [2m[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m [3mmain.tf [2m[3mLines 72-84
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m[2m   72[0m  [2mâ”‚[0m [0m[31mresource "aws_s3_bucket" "backups" {[0m
[0m[0m[2m   73[0m  [2mâ”‚[0m [0m[31m  bucket              = "${var.deploy_id}-backups"[0m
[0m[0m[2m   74[0m  [2mâ”‚[0m [0m[31m  force_destroy       = "false"[0m
[0m[0m[2m   75[0m  [2mâ”‚[0m [0m[31m  hosted_zone_id      = data.aws_route53_zone.this.zone_id[0m
[0m[0m[2m   76[0m  [2mâ”‚[0m [0m[31m  object_lock_enabled = "false"[0m
[0m[0m[2m   77[0m  [2mâ”‚[0m [0m[31m  tags                = var.tags[0m
[0m[0m[2m   78[0m  [2mâ”‚[0m [0m[31m[0m
[0m[0m[2m   79[0m  [2mâ”‚[0m [0m[31m  lifecycle {[0m
[0m[0m[2m   80[0m  [2mâ”‚[0m [0m[31m    ignore_changes = [[0m
[0m[0m[2m   81[0m  [2mâ”‚[0m [0m[31m      hosted_zone_id,[0m
[0m[0m[2m   82[0m  [2mâ”‚[0m [0m[31m    ][0m
[0m[0m[2m   83[0m  [2mâ”‚[0m [0m[31m  }[0m
[0m[0m[2m   84[0m  [2mâ”‚[0m [0m[31m}[0m
[0m[0m[2mâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m
[0m[0m  [2m        ID[0m [3maws-s3-specify-public-access-block
[0m[0m  [2m    Impact[0m Public access policies may be applied to sensitive data buckets
[0m[0m  [2mResolution[0m Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies
[0m[0m
  [2mMore Information[0m[0m[0m
  [2m-[0m [34mhttps://aquasecurity.github.io/tfsec/v1.15.4/checks/aws/s3/specify-public-access-block/[0m[0m
  [2m-[0m [34mhttps://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block#bucket[0m[0m
[2mâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€[0m


[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 329.114Âµs
[0m[0m  [2mparsing             [0m 5.215424ms
[0m[0m  [2madaptation          [0m 492.987Âµs
[0m[0m  [2mchecks              [0m 14.744622ms
[0m[0m  [2mtotal               [0m 20.782147ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 28
[0m[0m  [2mfiles read          [0m 4
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 6
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 30
[0m[0m  [2mmedium              [0m 10
[0m[0m  [2mlow                 [0m 5
[0m
[0m  [31m[1m6 passed, 45 potential problem(s) detected.

[0m[0m  [1mtimings[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mdisk i/o            [0m 218.636Âµs
[0m[0m  [2mparsing             [0m 13.747053ms
[0m[0m  [2madaptation          [0m 192.667Âµs
[0m[0m  [2mchecks              [0m 13.256097ms
[0m[0m  [2mtotal               [0m 27.414453ms
[0m
[0m  [1mcounts[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mmodules downloaded  [0m 0
[0m[0m  [2mmodules processed   [0m 1
[0m[0m  [2mblocks processed    [0m 9
[0m[0m  [2mfiles read          [0m 4
[0m
[0m  [1mresults[0m
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
[0m[0m  [2mpassed              [0m 0
[0m[0m  [2mignored             [0m 0
[0m[0m  [2mcritical            [0m 0
[0m[0m  [2mhigh                [0m 0
[0m[0m  [2mmedium              [0m 0
[0m[0m  [2mlow                 [0m 0
[0m
[0m
[32m[1mNo problems detected!

[0m
